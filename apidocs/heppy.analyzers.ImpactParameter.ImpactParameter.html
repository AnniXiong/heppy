<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>heppy.analyzers.ImpactParameter.ImpactParameter : API documentation</title>

    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link type="text/css" href="bootstrap.min.css" rel="stylesheet" />
    <link type="text/css" href="apidocs.css" rel="stylesheet" />
  </head>
  <body>

    <nav class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a href="index.html" class="navbar-brand">
            heppy API Documentation
          </a>
        </div>
      </div>
    </nav>

    <div id="showPrivate">
      <button onclick="togglePrivate()" class="btn btn-link">Toggle Private API</button>
    </div>

    <div class="container">

      <div class="page-header">
        <h1 class="class"><code>heppy.analyzers.ImpactParameter.ImpactParameter(<a href="heppy.framework.analyzer.Analyzer.html" data-type="Class" class="code">Analyzer</a>)</code> <small>class documentation</small></h1>

        <span id="partOf">
          Part of <code><a href="heppy.html" data-type="Package" class="code">heppy</a>.<a href="heppy.analyzers.html" data-type="Package" class="code">analyzers</a>.<a href="heppy.analyzers.ImpactParameter.html" data-type="Module" class="code">ImpactParameter</a></code>
          
          <a href="classIndex.html#heppy.analyzers.ImpactParameter.ImpactParameter">(View In Hierarchy)</a>
        </span>
      </div>

      <div class="extrasDocstring">
        
      </div>

      <div class="moduleDocstring">
        <pre>This analyzer puts an impact parameter for every charged particle
as an attribute of its path.
The significance is calculated, the calculus are a first order approximation,
thus this may not be correct for large impact parameters (more than 3 mm).
The Impact parameter significance is stored in the particle's path.

New attributes for heppy.papas.pfobjects.Particle.path (from compute_IP) :
*   closest_t = time of closest approach to the primary vertex.
*   IP = signed impact parameter
*   IPcoord = TVector3 of the point of closest approach to the
    primary vertex
    
New attributes for particles.path (from compute_theta_0) :
*   theta_0 = 1/sqrt(2) * gaussian width of the scattering angle
    due to the beam pipe. --&gt;  See pdg booklet, Passage of particles through matter,
    multiple scattering through small angles.
*   xX_0 = distance in number of X_0 the radiation length the particles goes through

New attributes for particles.path (from compute_IP_signif) :
*   IP_signif = the impact parameter significance. To get the uncertainty, just compute IP/IP_signif
*   IP_sigma = the uncertainty on the impact parameter
    
Then, several b-tagging methods are applied to each jet, with selected tracks :
*   a log-likelihood ratio based on Impact Parameter (IP_b_LL),
    if a numerator and a denominator for IP are provided (see example)
*   a log-likelihood ratio based on Impact Parameter Significance (IPs_b_LL),
    if a numerator and a denominator for IPs are provided (see example)
*   TCHE and TCHP taggers : using the second and third highest Impact Prameter for each jet

New attributes for jets :
*   TCHE = the value of the TCHE for this jet
*   TCHP = the value of the TCHP for this jet
*   TCHE_IP = the value of the IP of the track used to compute the TCHE
*   TCHP_IP = the value of the IP of the track used to compute the TCHE
*   TCHE_x = the x position of the vertex for the particle used for the TCHE
*   TCHE_y = the y position of the vertex for the particle used for the TCHE
*   TCHE_z = the z position of the vertex for the particle used for the TCHE
*   TCHE_pt = the transverse impulsion of the particle used for the TCHE
*   TCHE_dr = the cone containing the track used for the THCE with respects to the jet axis

Example of configuration : the root files contain the distributions of IP or IPs histograms (h_u, h_b ...)
that can be divided (num/denom) to get the ratio.

from heppy.papas.detectors.CMS import CMS
from heppy.analyzers.ImpactParameter import ImpactParameter
btag = cfg.Analyzer(
    ImpactParameter,
    jets = 'jets',
    
    # needed only for the IP_b_LL tagger
    # file and histogram key for b jet charged hadrons IP
    # num_IP = ("histo_stat_IP_ratio_bems.root","h_b"),
    # file and histogram key for u jet charged hadrons IP
    # denom_IP = ("histo_stat_IP_ratio_bems.root","h_u"),
    
    # needed only for the IPs_b_LL tagger
    # file and histogram key for b jet charged hadrons IPs
    # num_IPs = ("histo_stat_IPs_ratio_bems.root","h_b"),
    # file and histogram key for u jet charged hadrons IPs
    # denom_IPs = ("histo_stat_IPs_ratio_bems.root","h_u"),

    # selection of charged hadrons for b tagging 
    pt_min = 1, # pt threshold 
    dxy_max = 2e-3, # max impact parameter in transverse plane, in m, w/r origin 
    dz_max = 17e-2, # max longitudinal impact parameter in transverse plane, in m, w/r origin
    detector = CMS()
)    </pre>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id102">
  
  <tr class="method">
    
    <td>Method</td>
    <td><a href="heppy.analyzers.ImpactParameter.ImpactParameter.html#beginLoop" data-type="Method" class="code">beginLoop</a></td>
    <td><span>Automatically called by Looper, for all analyzers.</span></td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><a href="heppy.analyzers.ImpactParameter.ImpactParameter.html#ll_tag" data-type="Method" class="code">ll_tag</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><a href="heppy.analyzers.ImpactParameter.ImpactParameter.html#process" data-type="Method" class="code">process</a></td>
    <td><span>Automatically called by Looper, for all analyzers. each analyzer in the 
sequence will be passed the same event instance. each analyzer can access, 
modify, and store event information, of any type.</span></td>
  </tr>
</table>
        
          <p class="inheritedFrom">
            Inherited from <a href="heppy.framework.analyzer.Analyzer.html" data-type="Class" class="code">Analyzer</a>:
          </p>
          <table class="children sortable" id="id103">
  
  <tr class="basemethod">
    
    <td>Method</td>
    <td><a href="heppy.framework.analyzer.Analyzer.html#__init__" data-type="Method" class="code">__init__</a></td>
    <td><span>Create an analyzer.</span></td>
  </tr><tr class="basemethod">
    
    <td>Method</td>
    <td><a href="heppy.framework.analyzer.Analyzer.html#endLoop" data-type="Method" class="code">endLoop</a></td>
    <td><span>Automatically called by Looper, for all analyzers.</span></td>
  </tr><tr class="basemethod">
    
    <td>Method</td>
    <td><a href="heppy.framework.analyzer.Analyzer.html#write" data-type="Method" class="code">write</a></td>
    <td><span>Called by Looper.write, for all analyzers. Just overload it if you have 
histograms to write.</span></td>
  </tr><tr class="basemethod">
    
    <td>Method</td>
    <td><a href="heppy.framework.analyzer.Analyzer.html#__str__" data-type="Method" class="code">__str__</a></td>
    <td><span>A multipurpose printout. Should do the job for most analyzers.</span></td>
  </tr>
</table>
          

          
      </div>

      <div id="childList">

        <div class="basemethod">
  
  <a name="heppy.analyzers.ImpactParameter.ImpactParameter.beginLoop">
    
  </a>
  <a name="beginLoop">
    
  </a>
  <div class="functionHeader">
    
    def
    beginLoop(self, setup):
    
  </div>
  <div class="docstring functionBody">
    <div class="interfaceinfo">overrides <a href="heppy.framework.analyzer.Analyzer.html#beginLoop" data-type="Method" class="code">heppy.framework.analyzer.Analyzer.beginLoop</a></div>
    
    <div><p>Automatically called by Looper, for all analyzers.</p><table class="fieldTable"></table></div>
  </div>
</div><div class="basemethod">
  
  <a name="heppy.analyzers.ImpactParameter.ImpactParameter.ll_tag">
    
  </a>
  <a name="ll_tag">
    
  </a>
  <div class="functionHeader">
    
    def
    ll_tag(self, ratio_histo, ptc_var, jet_tag):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="basemethod">
  
  <a name="heppy.analyzers.ImpactParameter.ImpactParameter.process">
    
  </a>
  <a name="process">
    
  </a>
  <div class="functionHeader">
    
    def
    process(self, event):
    
  </div>
  <div class="docstring functionBody">
    <div class="interfaceinfo">overrides <a href="heppy.framework.analyzer.Analyzer.html#process" data-type="Method" class="code">heppy.framework.analyzer.Analyzer.process</a></div>
    
    <div><p>Automatically called by Looper, for all analyzers. each analyzer in the 
sequence will be passed the same event instance. each analyzer can access, 
modify, and store event information, of any type.</p><table class="fieldTable"></table></div>
  </div>
</div>

      </div>
      <address>
        <a href="index.html">API Documentation</a> for heppy, generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a> at 2016-11-02 16:20:55.
      </address>

    </div>

    <script type="text/javascript" src="pydoctor.js"></script>

  </body>
</html>